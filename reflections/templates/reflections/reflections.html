{% extends 'base.html' %}

{% block title %}
    Reflections
{% endblock %}

{% block scripts %}
    {% include 'reflections/js.html' %}
{% endblock %}

{% block content %}
    <div class=" justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <form action="{% url 'reflections:reflections'  %}" method="post">
      {% csrf_token %}
     <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 ">
        <h1 class="h2">Reflections</h1>
          <div class="btn-group btn-group-toggle" >
              {% for subject in subjects %}
                {% if subject.name == Subject %}
                   <label for="subject topic">
                    <input name="topic" id="topic" value="NULL" hidden>
                    <button class="btn btn-primary active" type="radio" type="submit" name="subject" maxlength="100" id="subject" autocomplete="off" value="{{subject.name}}">{{subject.name}}</button>
                  </label>
                {% else %}
                  <label  for="subject topic">
                    <input name="topic" id="topic" value="NULL" hidden>
                    <button class="btn btn-primary" type="radio" type="submit" name="subject" maxlength="100" id="subject" autocomplete="off" value="{{subject.name}}">{{subject.name}}</button>
                  </label>
                {% endif %}
              {% endfor %}
        </div>
        </div>
    </form>

    {% if Subject != "NULL" %}
          <form action="{% url 'reflections:reflections'  %}" method="post">
            {% csrf_token %}
           <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 ">
              <h1 class="h2"></h1>
                <div class="btn-group btn-group-toggle" >
                    {% for topic in topics %}
                      {% if topic.name == Topic %}
                         <label for="subject topic">
                          <input name="subject" id="subject" value="{{Subject}}" hidden>
                          <button class="btn btn-primary active" type="radio" type="submit" name="topic" maxlength="100" id="topic" autocomplete="off" value="{{topic.name}}">{{topic.name}}</button>
                        </label>
                      {% else %}
                        <label for="subject topic">
                          <input name="subject" id="subject" value="{{Subject}}" hidden>
                          <button class="btn btn-primary" type="radio" type="submit" name="topic" maxlength="100" id="topic" autocomplete="off" value="{{topic.name}}">{{topic.name}}</button>
                        </label>
                      {% endif %}
                    {% endfor %}
              </div>
              </div>
          </form>
          {% endif %}
        </div>

  


        <div class="d-flex">
            <div class="reflections col-12 px-4 shadow p-3 mb-5">
            <h2 class="text-center">Recent Reflections</h2>
            <div class="table-responsive">
        <table class="table">
          <tbody>
          {% for reflection in reflections %}
              <tr>
                  <td class="text-justify">
                    <div class="p-2 mb-2">
                      <b>Reflections: </b>{{ reflection.formatted_description }}
                    </div>
                      <table class="table shadow reflections">
                        <td style="width: 40%"><b> Expert Comments: </b>
                        {% if reflection.comments|length > 0 %}
                          {{ reflection.comments}}</td>
                        {% else %}
                          <td>-</td>
                        {% endif %}
                        <td style="width: 15%"><b>Subject: <br></b>{{ reflection.subject }}</td>
                        <td style="width: 15%"><b>Topic: <br></b>{% if reflection.topic == None %}
                          -
                          {% else %}
                              {{ reflection.topic_id }}
                          {% endif %}
                        </td>

                        <td style="width: 5%"><b>Accurate: <br></b>{{ reflection.accuracy_percentage }}%</td>
                        <td style="width: 5%"><b>Inaccuracy: </b>{{ reflection.inaccuracy_category}}</td>
                        <td style="width: 20%" ><b>Time: <br></b>{{ reflection.date}}</td></table>
                  </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
        </div>
      </div>
{% endblock %}